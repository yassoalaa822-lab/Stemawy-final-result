<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geology Checkpoints</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

    <style>
        /* Apply Inter font family and smooth scrolling */
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }

        /* --- Tech Aesthetic Colors and Glows --- */
        .shadow-subtle-glow {
            box-shadow: 0 4px 15px rgba(51, 255, 204, 0.25), 0 0 5px rgba(51, 255, 204, 0.1);
            transition: all 0.3s ease-in-out;
        }

        .hover\:shadow-subtle-glow-lg:hover {
            box-shadow: 0 6px 20px rgba(51, 255, 204, 0.4), 0 0 8px rgba(51, 255, 204, 0.2);
        }

        /* Keyframes for continuous gradient shift */
        @keyframes gradient-shift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* Base class for the animated text effect */
        .gradient-text-wrapper {
            display: inline-block;
            background-size: 300% 100%;
            animation: gradient-shift 8s linear infinite;
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            line-height: 1.2;
            white-space: nowrap;
        }

        /* Style for the main header */
        .gradient-h1 {
            background-image: linear-gradient(to right, #00BFFF, #33FFCC, #00BFFF, #33FFCC);
            animation-duration: 8s;
        }

        /* Light theme variables */
        :root[data-theme="light"] {
            --tech-bg: #ffffff;
            --tech-dark-alt: #f3f4f6;
            --tech-light: #111827;
            --tech-primary: #0369a1;
            --tech-secondary: #0e7490;
            --border-color: rgba(2, 132, 199, 0.3);
        }

        /* Dark theme variables (default) */
        :root[data-theme="dark"] {
            --tech-bg: #1A1F26;
            --tech-dark-alt: #2C333F;
            --tech-light: #E0E6F0;
            --tech-primary: #00BFFF;
            --tech-secondary: #33FFCC;
            --border-color: rgba(51, 255, 204, 0.3);
        }

        /* Space Theme Variables */
        :root[data-theme="space"] {
            --tech-bg: #050505;
            --tech-dark-alt: #0F1218;
            --tech-light: #ffffff;
            --tech-primary: #00BFFF;
            --tech-secondary: #33FFCC;
            --border-color: rgba(0, 191, 255, 0.3);
        }

        /* Midnight Synth Theme */
        :root[data-theme="midnight"] {
            --tech-bg: #1e1b4b;
            --tech-dark-alt: #312e81;
            --tech-light: #e0e7ff;
            --tech-primary: #f472b6;
            --tech-secondary: #818cf8;
            --border-color: rgba(244, 114, 182, 0.4);
        }

        /* Christmas Theme */
        :root[data-theme="christmas"] {
            --tech-bg: #2C0412;
            --tech-dark-alt: #460B1C;
            --tech-light: #FEEBC8;
            --tech-primary: #D4AF37;
            --tech-secondary: #228B22;
            --border-color: rgba(212, 175, 55, 0.4);
        }

        body {
            background-color: var(--tech-bg);
            color: var(--tech-light);
        }

        .bg-tech-bg {
            background-color: var(--tech-bg) !important;
        }

        .bg-tech-dark-alt {
            background-color: var(--tech-dark-alt) !important;
        }

        .text-tech-light {
            color: var(--tech-light) !important;
        }

        .text-tech-primary {
            color: var(--tech-primary) !important;
        }

        .text-tech-secondary {
            color: var(--tech-secondary) !important;
        }

        /* Custom scrollbar style for the content area */
        #content-area {
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #00BFFF #1A1F26;
        }

        #content-area::-webkit-scrollbar {
            width: 8px;
        }

        #content-area::-webkit-scrollbar-thumb {
            background-color: #00BFFF;
            border-radius: 4px;
        }

        #content-area::-webkit-scrollbar-track {
            background-color: #1A1F26;
        }

        /* Custom style for the LO button when active */
        .lo-item.active {
            background-color: #00BFFF33;
            /* tech-primary with opacity */
            border-left-color: #33FFCC;
            /* tech-secondary */
            box-shadow: 0 0 10px rgba(51, 255, 204, 0.3);
        }

        /* Details summary arrow rotation */
        details[open] summary .arrow-icon {
            transform: rotate(90deg);
        }

        /* Theme toggle button */
        .theme-toggle {
            padding: 0.5rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            color: var(--tech-light);
        }

        .theme-toggle:hover {
            background-color: var(--tech-primary);
            color: var(--tech-bg);
        }

        /* Enforce CSS Variables */
        .bg-tech-dark-alt {
            background-color: var(--tech-bg) !important;
        }

        .bg-tech-dark-alt {
            background-color: var(--tech-dark-alt) !important;
        }

        .text-tech-light {
            color: var(--tech-light) !important;
        }

        .text-tech-primary {
            color: var(--tech-primary) !important;
        }

        .text-tech-secondary {
            color: var(--tech-secondary) !important;
        }

        .border-tech-primary {
            border-color: var(--tech-primary) !important;
        }

        .border-tech-secondary {
            border-color: var(--tech-secondary) !important;
        }

        /* Christmas Theme */
        :root[data-theme="christmas"] {
            --tech-bg: #2C0412;
            --tech-dark-alt: #460B1C;
            --tech-light: #FDF5E6;
            --tech-primary: #FFD700;
            --tech-secondary: #006400;
            --border-color: rgba(255, 215, 0, 0.4);
        }

        /* Snow */
        #snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
            display: none;
        }

        :root[data-theme="christmas"] #snow-container {
            display: block;
        }

        .snowflake {
            position: absolute;
            top: -10px;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(110vh);
            }
        }

        /* RTL */
        [dir="rtl"] {
            font-family: 'Tajawal', 'Inter', sans-serif;
        }

        [dir="rtl"] .text-right-rtl {
            text-align: right;
        }

        [dir="rtl"] #sidebar {
            border-left: 1px solid var(--tech-primary);
            border-right: none;
            margin-left: 1.5rem;
            margin-right: 0;
        }

        #settings-modal {
            backdrop-filter: blur(5px);
        }

        /* --- Dark Neon Dynamic Background --- */
        .cyber-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
            display: none;
        }

        /* Only show in Dark Theme */
        :root[data-theme="dark"] .cyber-wrapper {
            display: block;
        }

        .cyber-grid {
            position: absolute;
            width: 200vw;
            height: 200vh;
            top: -50%;
            left: -50%;
            background-image:
                linear-gradient(rgba(0, 191, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 191, 255, 0.05) 1px, transparent 1px);
            background-size: 60px 60px;
            transform: perspective(500px) rotateX(60deg);
            animation: grid-move 20s linear infinite;
        }

        @keyframes grid-move {
            0% {
                transform: perspective(500px) rotateX(60deg) translateY(0);
            }

            100% {
                transform: perspective(500px) rotateX(60deg) translateY(60px);
            }
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float-orb 20s infinite ease-in-out;
        }

        .orb-1 {
            top: 20%;
            left: 20%;
            width: 300px;
            height: 300px;
            background: rgba(0, 191, 255, 0.3);
            animation-duration: 25s;
        }

        .orb-2 {
            bottom: 20%;
            right: 20%;
            width: 400px;
            height: 400px;
            background: rgba(51, 255, 204, 0.2);
            animation-duration: 30s;
            animation-delay: -5s;
        }

        .orb-3 {
            top: 50%;
            left: 50%;
            width: 200px;
            height: 200px;
            background: rgba(138, 43, 226, 0.15);
            animation-duration: 20s;
            animation-delay: -10s;
        }

        @keyframes float-orb {

            0%,
            100% {
                transform: translate(0, 0);
            }

            33% {
                transform: translate(40px, -60px);
            }

            66% {
                transform: translate(-30px, 30px);
            }
        }

        /* Breathing Glow for Cards in Dark Mode */
        :root[data-theme="dark"] .subject-card,
        :root[data-theme="dark"] .comp-card,
        :root[data-theme="dark"] .lo-item,
        :root[data-theme="dark"] details {
            animation: breathing-glow 5s ease-in-out infinite;
        }

        :root[data-theme="dark"] .subject-card:hover,
        :root[data-theme="dark"] .comp-card:hover,
        :root[data-theme="dark"] .lo-item:hover,
        :root[data-theme="dark"] details[open] {
            animation: none;
        }

        @keyframes breathing-glow {

            0%,
            100% {
                box-shadow: 0 0 5px rgba(0, 191, 255, 0.05);
                border-color: rgba(0, 191, 255, 0.1);
            }

            50% {
                box-shadow: 0 0 15px rgba(51, 255, 204, 0.15);
                border-color: rgba(51, 255, 204, 0.3);
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

    <script>
        // Tailwind Configuration with the same Modern Tech Palette
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'tech-bg': '#1A1F26',
                        'tech-dark-alt': '#2C333F',
                        'tech-light': '#E0E6F0',
                        'tech-primary': '#00BFFF',
                        'tech-secondary': '#33FFCC',
                    }
                }
            }
        }

        // Define the learning objectives data structure
        const learningObjectives = {
            LO1: {
                title: "LO1: Introduction to Geology",
                concepts: ["The contribution of geology to the different domains in our lives"],
                testBankUrl: "https://your-host.com/files/geology/LO1_TestBank.pdf"
            },
            LO2: {
                title: "LO2: Minerals and Their Properties",
                concepts: [
                    "Minerals are homogeneous solid earth materials.",
                    "Minerals have distinct physical properties that enable them to be distinguished from one another.",
                    "For most common minerals, the most useful properties for hand sample identification include hardness, cleavage or fracture patterns, translucency, and color.",
                    "Metallic minerals are uncommon, but economically important.",
                    "For metallic minerals, the additional properties of streak and magnetism are useful for hand sample identification",
                    "Completely unambiguous identification of minerals often requires sophisticated laboratory analysis.",
                    "Some construction materials are highly refined from the original Earth material, while others are used in the original state."
                ],
                testBankUrl: "https://your-host.com/files/geology/LO2_TestBank.pdf"
            },
            LO3: {
                title: "LO3: Engineering Properties",
                concepts: [
                    "Different Earth materials and different manufactured materials have different engineering properties, such as their behavior under stress, making them suitable for different uses in construction."
                ],
                testBankUrl: "https://your-host.com/files/geology/LO3_TestBank.pdf"
            },
            LO4: {
                title: "LO4: Igneous Rocks",
                concepts: [
                    "Rocks are heterogeneous mixtures of minerals and (rarely) other earth materials.",
                    "Igneous rocks cooled from melts are found in association with volcanoes and also as rocks that cooled underground",
                    "Different cooling histories produce different igneous textures.",
                    "Differences in magma composition and eruption location create differences in eruption explosivity that affect volcanic rock textures."
                ],
                testBankUrl: "https://your-host.com/files/geology/LO4_TestBank.pdf"
            },
            LO5: {
                title: "LO5: Sedimentary Rocks",
                concepts: [
                    "Sedimentary rocks that accumulate from particles can be formed in a wide range of environments on Earth's surface",
                    "Some sedimentary rocks form from particles of older rocks that are removed from their original location and deposited in a new one.",
                    "The environment of deposition and the source material both contribute to differences in texture and composition among these sedimentary rocks.",
                    "Some sedimentary rocks are made of particles from once living organisms.",
                    "The types of organisms determine much about the texture and mineral composition of such rocks",
                    "Sedimentary rocks often contain pore spaces that make them important reservoirs of fluids in the upper part of Earth's crust.",
                    "Sedimentary rocks sometimes contain organic material that may become part of Earth's energy resources",
                    "Limestone and cement materials derived from limestone are essential Egyptian building resources due both to their abundance and to the lack of alternative building materials."
                ],
                testBankUrl: "https://your-host.com/files/geology/LO5_TestBank.pdf"
            },
            LO6: {
                title: "LO6: Metamorphic Rocks",
                concepts: [
                    "Changes in temperature, pressure, or composition in Earth's subsurface can change the texture and mineral composition of pre-existing rocks,creating metamorphic rocks",
                    "Deformation during metamorphism produces foliated textures and may destroy original textures.",
                    "Deformation (change in shape) and stresses (distribution of forces) are related, but maximum deformation and maximum stress are not always parallel.",
                    "The metamorphic texture and mineralogy observed in metamorphic rocks are most commonly related to the conditions when the rock experienced its maximum temperature."
                ],
                testBankUrl: "https://your-host.com/files/geology/LO6_TestBank.pdf"
            },
            LO7: {
                title: "LO7: Rock Cycle and Geological History",
                concepts: [
                    "The rock cycle is a group of processes that act on the different types of rocks and change rocks from one form to another over geologic time",
                    "Rock composition and texture provides evidence that can be interpreted to yield a geologic history",
                    "Interpreting cross sections to study the age relationships of different rock units.",
                    "Interpreting different geological maps that show outcrops of different rocks of Egypt."
                ],
                testBankUrl: "https://your-host.com/files/geology/LO7_TestBank.pdf"
            },
        };

        // Resource files (presentations) per LO and central test banks/revisions
        const resourceFiles = {
            LO1: [
                'first semester/LO1/Geology  Its Branches and Scope.pdf',
                'first semester/LO1/Geology L.O 1 grade 10.pptx'
            ],
            LO2: [
                'first semester/LO2/Geology L.O 2 grade 10.pptx',
                'first semester/LO2/minerals 2.ppt',
                'first semester/LO2/Minerals by Rushdy saad VIP.pptx'
            ],
            LO3: [
                'first semester/LO3/Building Materials  ( gr 3 ).pdf',
                'first semester/LO3/building materials ppt  v.v.2nd sess   important.pptx',
                'first semester/LO3/Building_materials (1).pdf',
                'first semester/LO3/Geology L.O3.ppt',
                'first semester/LO3/LO .1.03 Building Materials 2017.pdf',
                'first semester/LO3/LO ES1.03 Earth Materials 2017.pdf',
                'first semester/LO3/lo3 building materials  مهم جدا SESS1.pptx'
            ],
            LO4: [
                'first semester/LO4/Chapter 3 Intrusive igneous rocks v.v.imp.ppt',
                'first semester/LO4/Geo L.O4 +.pptx',
                'first semester/LO4/Geology L.O4.pptx'
            ],
            LO5: [
                'first semester/LO5/Chapter 6 Sedimentary Rocks للشرح.ppt',
                'first semester/LO5/Geology L.O 5 grade 10.pptx',
                'first semester/LO5/Geology L.O 5.pptx'
            ],
            LO6: [
                'first semester/LO6/Geology L.O 6 grade 10.pptx',
                'first semester/LO6/Geology L.O 6.pptx'
            ],
            LO7: [
                'first semester/LO7/Geology L.O 7 grade 10.pptx',
                'first semester/LO7/Geology L.O 7.pptx',
                'first semester/LO7/LO1.07.pdf',
                'first semester/LO7/rock cycle.ppt'
            ],
            testBanks: [
                'first semester/test banks/G10 queeze.pdf',
                'first semester/test banks/Geo Quiz LO1.01.pdf',
                'first semester/test banks/igneous test.PNG',
                'first semester/test banks/IgneousVers2 QUIZ AND ANSWER.pdf',
                'first semester/test banks/L.O 7 quizz and answer.docx',
                'first semester/test banks/LO 6 quizz with answer.docx',
                'first semester/test banks/metamorphic quiz.doc',
                'first semester/test banks/Metamorphic Rocks Quiz.docx',
                'first semester/test banks/Minerals QUESTION AND ANSWERS.pdf',
                'first semester/test banks/Quiz LO1.01.pdf',
                'first semester/test banks/quiz-on-igneous-rocks.rtf',
                'first semester/test banks/quiz-on-sedimentary.rtf',
                'first semester/test banks/quizz and answer on metamorphic.pdf',
                'first semester/test banks/Rock Pre QUIZ AND ANSWER.pdf'
            ],
            revisions: [
                'first semester/revisions/geology_G_10_.pdf'
            ],
            additionalReferences: [
                'first semester/additional refrences/CK-12-Earth-Science-For-High-School-Workbook-with-Answers-١.pdf',
                'first semester/additional refrences/Earth Com/Part 1 (1) EARTH.COMM BOOK.pdf',
                'first semester/additional refrences/Earth Com/Part 2 (1)EA RTH.COMM BOOK.pdf',
                'first semester/additional refrences/ESSENTIAL/ES student ebook (1).pdf',
                'first semester/additional refrences/ESSENTIAL/Essentials of geologe 11th edetion.pdf',
                'first semester/additional refrences/Physical Geology book/Chapter-14-Groundwater-21-01.pdf',
                'first semester/additional refrences/Physical Geology book/Chapter-16-Glaciation-v.2.06.pdf',
                'first semester/additional refrences/Physical Geology book/Chapter-7-Metamorphism-and-Metamorphic-Rocks-21-01.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-1-Introduction-to-Geology.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-10-Plate-Tectonics.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-11-Earthquakes.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-12-Geological-Structures.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-13-Streams-and-Floods.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-18-Geology-of-the-Oceans.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-2-Minerals.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-20-Geological-Resources.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-22-The-Origin-of-Earth-and-the-Solar-System.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-3-Intrusive-Igneous-Rocks.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-4-Volcanism.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-5-Weathering-and-Soil.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-6-Sediments-and-Sedimentary-Rocks.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-8-Measuring-Geological-Time.pdf',
                'first semester/additional refrences/Physical Geology book/Physical-Geology-2nd-Edition-Chapter-9-Earths-Interior.pdf'
            ]
        };

        // Map of filename -> Google Drive share URL (from CSV)
        const shareMap = {
            "Geology  Its Branches and Scope.pdf": "https://drive.google.com/file/d/1bOUSB_Et7jp1PzcHh-I6z02-ZIXKEi4l/view?usp=drivesdk",
            "Geology L.O 1 grade 10.pptx": "https://docs.google.com/presentation/d/1Ko01DC5NTdihxK7lm8_LG5hvr_xIZoJU/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 2 grade 10.pptx": "https://docs.google.com/presentation/d/11R_GpEd4qqIc9LzvnMv8Ojga4cWVY_ud/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "minerals 2.ppt": "https://docs.google.com/presentation/d/1YnvtFVyUVossyZwdJfmpq07VQZyjmdBS/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Minerals by Rushdy saad VIP.pptx": "https://docs.google.com/presentation/d/1zfPteZnklqVnC-06LiZKPR-elKv_tckQ/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Building Materials  ( gr 3 ).pdf": "https://drive.google.com/file/d/1lLOlMopdffLLl7C2pW7o8hzLsR6XZoAu/view?usp=drivesdk",
            "building materials ppt  v.v.2nd sess   important.pptx": "https://docs.google.com/presentation/d/1reLfi13oC-4jBKrNWVQYDR7r2olS3gdy/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Building_materials (1).pdf": "https://drive.google.com/file/d/1mRh_AYT8mQfue-SyApFhTI6GDU1RLO11/view?usp=drivesdk",
            "Geology L.O3.ppt": "https://docs.google.com/presentation/d/1oSr9B8sdJYLzPb2X1L5u5T1r3AsB3_D_/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "LO .1.03 Building Materials 2017.pdf": "https://drive.google.com/file/d/1BZw9NpH51lY-Vd7brhyWwhr_rg-EhcS4/view?usp=drivesdk",
            "LO ES1.03 Earth Materials 2017.pdf": "https://drive.google.com/file/d/1GhwnrlZSkkweRR9DHtOmaBGg7VIWpY8o/view?usp=drivesdk",
            "lo3 building materials  مهم جدا SESS1.pptx": "https://docs.google.com/presentation/d/1kKzsJNWJDu57PAtnYUAVYIsqmQeMWjNE/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Chapter 3 Intrusive igneous rocks v.v.imp.ppt": "https://docs.google.com/presentation/d/1ecbl6gTZ0DT3NdYb2mbfbtId5tsW8XeN/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geo L.O4 +.pptx": "https://docs.google.com/presentation/d/1R8WKNkyeU3nDnyD7kWBi1ca0i_F25eYX/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O4.pptx": "https://docs.google.com/presentation/d/1T4QWflZ-Y9W2zqGmKZmD5YdsKmzFFL1H/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Chapter 6 Sedimentary Rocks للشرح.ppt": "https://docs.google.com/presentation/d/1T1jL2wyXsmPLfo1RAmT0qudkSCu7MSAV/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 5 grade 10.pptx": "https://docs.google.com/presentation/d/1OrWYjpIXh4C50mq2S9HeB8q6xwCkDTgD/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 5.pptx": "https://docs.google.com/presentation/d/1J2uQ8p8naNLxOB85PgiR9-EQQ9SJDZDY/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 6 grade 10.pptx": "https://docs.google.com/presentation/d/1-C0nsI5mqJp1XFaG_vk_O7Qt74pwWFcX/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 6.pptx": "https://docs.google.com/presentation/d/1XGRqeQ4J5DvqNSQlHyhG8AGLSgOzZusH/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 7 grade 10.pptx": "https://docs.google.com/presentation/d/10thYKW9fom1wqS4eD9jGgukDcBj_qUbf/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Geology L.O 7.pptx": "https://docs.google.com/presentation/d/16KTN-cPq3ckl2m1W96JA45jroDuy3uyb/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "LO1.07.pdf": "https://drive.google.com/file/d/1eilAkXBzFLv02pbdz1PhhcOf09mKHeyn/view?usp=drivesdk",
            "rock cycle.ppt": "https://docs.google.com/presentation/d/1h2U15C4VCv5FfzRFDthC1cw8PqNlAvzI/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "G10 queeze.pdf": "https://drive.google.com/file/d/1-fK4P0lbBwCQz0-G50kyUCf5-nyES89d/view?usp=drivesdk",
            "Geo Quiz LO1.01.pdf": "https://drive.google.com/file/d/1_en6bf2orNxnrxH5ATNhvSSNLn2bvR_v/view?usp=drivesdk",
            "igneous test.PNG": "https://drive.google.com/file/d/1GwurogFLm5GINKzoLg0rIyXhfnYjOhR1/view?usp=drivesdk",
            "IgneousVers2 QUIZ AND ANSWER.pdf": "https://drive.google.com/file/d/1K8k6K8QC82TLNHaLrKHC5WkzgBanxrhL/view?usp=drivesdk",
            "L.O 7 quizz and answer.docx": "https://docs.google.com/document/d/1JoX40gpBCSVS56a2s0L0hLJaAfLKQBmr/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "LO 6 quizz with answer.docx": "https://docs.google.com/document/d/1-8T-5Lbi_BRVBLkLkioq5O73z07Z1grS/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "metamorphic quiz.doc": "https://docs.google.com/document/d/1U30IdRo95BNCjurdt68cXvu5Au-iuu-E/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Metamorphic Rocks Quiz.docx": "https://docs.google.com/document/d/135Xbf3xRIOSF3LQpwykFbrvEZBjlV4ue/edit?usp=drivesdk&ouid=101563598129890605704&rtpof=true&sd=true",
            "Minerals QUESTION AND ANSWERS.pdf": "https://drive.google.com/file/d/1gNSoBkAbLEPHDjyDAhkSJ8FBfjJEdXwa/view?usp=drivesdk",
            "Quiz LO1.01.pdf": "https://drive.google.com/file/d/1IqDEbMpjIQ02f1s-Y4OKVXO1PPBV77r2/view?usp=drivesdk",
            "quizz and answer on metamorphic.pdf": "https://drive.google.com/file/d/1en-kSDm4eTrl9cXFHP5ZTkgOvKX0woW4/view?usp=drivesdk",
            "Rock Pre QUIZ AND ANSWER.pdf": "https://drive.google.com/file/d/1SwvG3_q3iS-g0vKIZJy1o0GJe9fPaYun/view?usp=drivesdk",
            "geology_G_10_.pdf": "https://drive.google.com/file/d/1B-e8K2XCuII1ZibvvUax30EqP5U3xC3N/view?usp=drivesdk",
            "CK-12-Earth-Science-For-High-School-Workbook-with-Answers-١.pdf": "https://drive.google.com/file/d/1oK16UY5G9XK74-0cdoV_lw1goewaL3LE/view?usp=drivesdk",
            "Part 1 (1) EARTH.COMM BOOK.pdf": "https://drive.google.com/file/d/1Tx27jLfqonvJBfrLtLjdail0pG5v3Jaj/view?usp=drivesdk",
            "Part 2 (1)EA RTH.COMM BOOK.pdf": "https://drive.google.com/file/d/1PuLQBmFV_AlfgNeLBqXWLBbaG5KKQsHR/view?usp=drivesdk",
            "ES student ebook (1).pdf": "https://drive.google.com/file/d/17TtGX7zNM-NVJ4Hmpp61iFIMtdknB2Es/view?usp=drivesdk",
            "Essentials of geologe 11th edetion.pdf": "https://drive.google.com/file/d/1eOpEnb6Y2MTQUeZE9RydHA7GV9VHU8qx/view?usp=drivesdk",
            "Chapter-14-Groundwater-21-01.pdf": "https://drive.google.com/file/d/1_JjL080jGHqrlJsAB32v7kTWGvDXYI_F/view?usp=drivesdk",
            "Chapter-16-Glaciation-v.2.06.pdf": "https://drive.google.com/file/d/1-ZU__2y_CzusVdokLFJmYVlik4Dn2coz/view?usp=drivesdk",
            "Chapter-7-Metamorphism-and-Metamorphic-Rocks-21-01.pdf": "https://drive.google.com/file/d/1cIFk84-c8ZRSxtiwUTXU7pf-Q0jsx4uD/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-1-Introduction-to-Geology.pdf": "https://drive.google.com/file/d/1WQJnEpFnLJW1AzD6UtLrIHavH8lMlcTh/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-10-Plate-Tectonics.pdf": "https://drive.google.com/file/d/16PFMVrj34Oh_sJ1kLVOgliu66dscCi-f/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-11-Earthquakes.pdf": "https://drive.google.com/file/d/1u9JdPhqsANzm0LtBKGLTRfZZRCn9WLah/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-12-Geological-Structures.pdf": "https://drive.google.com/file/d/1fp8k6R6rftg5BhBSZyiHogXBdDuelS4h/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-13-Streams-and-Floods.pdf": "https://drive.google.com/file/d/18ZyvAZztYcvv66ICJgdQByaUO3FKH2hJ/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-18-Geology-of-the-Oceans.pdf": "https://drive.google.com/file/d/1d8PZi7VrxQ2__KaEbR3RxIvTG6QcI1j5/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-2-Minerals.pdf": "https://drive.google.com/file/d/1iVFZYdY6_dBIa6oHCpJm2q5jQcjLK5y_/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-20-Geological-Resources.pdf": "https://drive.google.com/file/d/1y6AaLbgYCmE-gHIjliZAUFwlhLWlTSlL/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-22-The-Origin-of-Earth-and-the-Solar-System.pdf": "https://drive.google.com/file/d/1yMaFJdMCzOiXlgIGlah-F51ng8Pdrq-/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-3-Intrusive-Igneous-Rocks.pdf": "https://drive.google.com/file/d/1Ul954N_CngDqT_XjSsIXuEJInVTStzqv/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-4-Volcanism.pdf": "https://drive.google.com/file/d/1dXF49nKa7QdcqbP49MvnGO5cJsxKOHby/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-5-Weathering-and-Soil.pdf": "https://drive.google.com/file/d/1P46H-g9Ce0JBXEj_fQntL2msZbo0xhJl/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-6-Sediments-and-Sedimentary-Rocks.pdf": "https://drive.google.com/file/d/1vy6H7AyAI7c-rQmxSTnkYjGC7we5bG_m/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-8-Measuring-Geological-Time.pdf": "https://drive.google.com/file/d/1skcfxNWMnCyddJ9MPLDOvohPPbqYpCfv/view?usp=drivesdk",
            "Physical-Geology-2nd-Edition-Chapter-9-Earths-Interior.pdf": "https://drive.google.com/file/d/1sLjwjy05I5NQMqyHzIgZLB0ega6h94Yb/view?usp=drivesdk",
            "quiz-on-sedimentary.rtf": "https://drive.google.com/file/d/1CCEr84KDYyzL8NFiBE6GnjQ2O4Z8sNL_/view?usp=drivesdk",
            "quiz-on-igneous-rocks.rtf": "https://drive.google.com/file/d/1hPA8eWfcNLKHfTFmYYOLZ--w_5_5dytN/view?usp=drivesdk"
        };

        // Video links: LO-level summarized videos and concept-specific videos
        const videoLinks = {
            loSummarized: {
                LO1: 'https://youtu.be/ZYl02U-FxF8?si=iDotF9V0dfXaoQEe',
                LO2: 'https://youtu.be/L880CG3ZeeI?si=7aFV79RcCe_TQc18',
                LO3: 'https://youtu.be/XJ3OH1T2uYE?si=_zHNWhKlIVUnCrQM',
                LO4: 'https://youtu.be/lp6n5Q8TuZ0?si=qkpzvX9RmS8tfhZv',
                LO5: 'https://youtu.be/ndpJGDrkrg0?si=X9aJavhWeVASBdws',
                LO6: 'https://youtu.be/ndpJGDrkrg0?si=uZnHlbfOu3JIsC-N',
                LO7: 'https://youtu.be/zI7pMjkkQ6w?si=zr-HTfVoh5qqw37s'
            },
            concept: {
                "The contribution of geology to the different domains in our lives": 'https://youtu.be/k_CB-qGytJE?si=ao6pHNN7Uttd4w9w',
                "Minerals are homogeneous solid earth materials.": 'https://youtu.be/x89JhH1FA7I?si=LQivIBHCDtllv7Ln',
                "Minerals have distinct physical properties that enable them to be distinguished from one another.": 'https://youtu.be/M4rzNUZFV4w?si=SGMBWloA1K8EMF4K',
                "For most common minerals, the most useful properties for hand sample identification include hardness, cleavage or fracture patterns, translucency, and color.": 'https://youtu.be/1SGC3VBQZY0?si=bawZ2bzAao9tHnNL',
                "Metallic minerals are uncommon, but economically important.": 'https://youtu.be/BowQcGw9IYk?si=eCkyGOlRs6vGVRLa',
                "For metallic minerals, the additional properties of streak and magnetism are useful for hand sample identification": 'https://youtu.be/7nacSPqZg8U?si=kGawUS7FSGA2Bxkl',
                "Completely unambiguous identification of minerals often requires sophisticated laboratory analysis.": 'https://youtu.be/__yBpEzjSUg?si=DYzmrpt89LC37zSe',
                "Some construction materials are highly refined from the original Earth material, while others are used in the original state.": 'https://youtu.be/1iNpON9ckTg?si=yAI9cnTrtY7CeUaD',
                "Different Earth materials and different manufactured materials have different engineering properties, such as their behavior under stress, making them suitable for different uses in construction.": 'https://youtu.be/zk5FZhUD5a4?si=hXemCntqlIgMjc_A',
                "Rocks are heterogeneous mixtures of minerals and (rarely) other earth materials.": 'https://youtu.be/CeuYx-AbZdo?si=RVRHfSI3HPMNiZp3',
                "Igneous rocks cooled from melts are found in association with volcanoes and also as rocks that cooled underground": 'https://youtu.be/cuFGMk_sDa4?si=h_obNzfKiik0bSFx',
                "Different cooling histories produce different igneous textures.": 'https://youtu.be/8tmwCrlLnUk?si=Vvl0Y97q-cwdRRoP',
                "Differences in magma composition and eruption location create differences in eruption explosivity that affect volcanic rock textures.": 'https://youtu.be/Ovsj1SyGnGM?si=16M_70qeeZwKETN8',
                "Sedimentary rocks that accumulate from particles can be formed in a wide range of environments on Earth's surface": 'https://youtu.be/x0lauGbQWvQ?si=xUOFR7aA5k8JRnqV',
                "Some sedimentary rocks form from particles of older rocks that are removed from their original location and deposited in a new one.": 'https://youtu.be/Etu9BWbuDlY?si=mlKlDEQmD04L3-TQ',
                "The environment of deposition and the source material both contribute to differences in texture and composition among these sedimentary rocks.": 'https://youtu.be/ptq3h6WZWYg?si=rwtXzcNr9qYmHTtM',
                "Some sedimentary rocks are made of particles from once living organisms.": 'https://youtu.be/kq4DJY_5ASY?si=eHhct9Si46_mxanA',
                "The types of organisms determine much about the texture and mineral composition of such rocks": 'https://youtu.be/Qqdf_26NVW0?si=LF9vg6RTLXFYF6qw',
                "Sedimentary rocks often contain pore spaces that make them important reservoirs of fluids in the upper part of Earth's crust.": 'https://youtu.be/cSCNAMEmLGk?si=vANlg6-pS0rH7KfG',
                "Sedimentary rocks sometimes contain organic material that may become part of Earth's energy resources": 'https://youtu.be/XEozX2Av3rc?si=TVmhAyEJsNwY5eHs',
                "Limestone and cement materials derived from limestone are essential Egyptian building resources due both to their abundance and to the lack of alternative building materials.": 'https://youtu.be/syBiqjoHyIA?si=Zy66_VPYKAv7XhGK',
                "Changes in temperature, pressure, or composition in Earth's subsurface can change the texture and mineral composition of pre-existing rocks,creating metamorphic rocks": 'https://youtu.be/0QTkumoJnuU?si=waOt9EEHb3ur3fnO',
                "Deformation during metamorphism produces foliated textures and may destroy original textures.": 'https://youtu.be/K-fQ0iBckG0?si=Fj5vmPowlD_5VeRP',
                "Deformation (change in shape) and stresses (distribution of forces) are related, but maximum deformation and maximum stress are not always parallel.": 'https://youtu.be/7DuVsDOKUJM?si=bDsFSHNLsr0gx2MQ',
                "The metamorphic texture and mineralogy observed in metamorphic rocks are most commonly related to the conditions when the rock experienced its maximum temperature.": 'https://youtu.be/vL9lr0vXLFw?si=x6cxCN6Z6vrgfrMY',
                "Rock composition and texture provides evidence that can be interpreted to yield a geologic history": 'https://youtu.be/fYSeM63Fv0s?si=0oZFWi9AopO8JcFu',
                "Interpreting cross sections to study the age relationships of different rock units.": 'https://youtu.be/GpFAy9tGCgI?si=hafn7Kig87pUS3Nn',
                "Interpreting different geological maps that show outcrops of different rocks of Egypt.": 'https://youtu.be/thUcu1lXEX4?si=ZPtL5_esPc678o2E'
            }
        };

        // Function to create a single downloadable link block
        function createLinkBlock(title, placeholderText) {
            const mockDownloadLink = "javascript:void(0)";
            return `
                <div class="mt-3 p-3 bg-tech-dark-alt/50 rounded-lg border border-tech-dark-alt">
                    <h4 class="text-md font-bold text-tech-secondary mb-1">${title}</h4>
                    <p class="text-sm text-tech-light/70 italic mb-2">${placeholderText}</p>
                    <a href="${mockDownloadLink}" download="${title.replace(/\s/g, '_')}_file.pdf" 
                        class="text-tech-primary hover:text-tech-secondary transition duration-200 text-sm underline font-semibold">
                        Download File Link (Placeholder)
                    </a>
                </div>
            `;
        }

        // Render list of presentation files for a given LO
        function renderPresentations(loKey) {
            const files = resourceFiles[loKey] || [];
            if (!files.length) return '';
            let html = `
                <div class="mt-6 p-4 bg-tech-dark-alt/60 rounded-lg border border-tech-dark-alt">
                    <h3 class="text-xl font-bold text-tech-secondary mb-3">Presentations</h3>
                    <ul class="space-y-2">
            `;
            files.forEach(f => {
                let url = f;
                let name = '';
                if (typeof f === 'string') {
                    name = f.split('/').pop();
                    if (shareMap[name]) url = shareMap[name];
                } else if (typeof f === 'object') {
                    name = f.name || f.title || '';
                    url = f.url || f.href || url;
                }
                html += `<li><a href="${url}" target="_blank" rel="noopener noreferrer" class="text-tech-primary hover:text-tech-secondary underline">${name}</a></li>`;
            });
            html += `</ul></div>`;
            return html;
        }

        function renderTestBanks() {
            const files = resourceFiles.testBanks || [];
            if (!files.length) return `<p class="text-tech-light/70">No test bank files.</p>`;
            let html = `
                <h2 class="text-2xl font-bold text-tech-secondary mb-4">Test Banks</h2>
                <div class="p-3 bg-tech-dark-alt/60 rounded-lg border border-tech-dark-alt">
                    <ul class="space-y-2">
            `;
            files.forEach(f => { const name = f.split('/').pop(); const url = shareMap[name] || f; html += `<li><a href="${url}" target="_blank" rel="noopener noreferrer" class="text-tech-primary underline">${name}</a></li>`; });
            html += `</ul></div>`;
            return html;
        }

        function renderRevisions() {
            const files = resourceFiles.revisions || [];
            if (!files.length) return `<p class="text-tech-light/70">No revision files yet.</p>`;
            let html = `
                <h2 class="text-2xl font-bold text-tech-secondary mb-4">Revisions</h2>
                <div class="p-3 bg-tech-dark-alt/60 rounded-lg border border-tech-dark-alt">
                    <ul class="space-y-2">
            `;
            files.forEach(f => { const name = f.split('/').pop(); const url = shareMap[name] || f; html += `<li><a href="${url}" target="_blank" rel="noopener noreferrer" class="text-tech-primary underline">${name}</a></li>`; });
            html += `</ul></div>`;
            return html;
        }

        function renderAdditionalResources() {
            const files = resourceFiles.additionalReferences || [];
            if (!files.length) return `<p class="text-tech-light/70">No additional resources available.</p>`;
            let html = `
                <h2 class="text-2xl font-bold text-tech-secondary mb-4">Additional Resources</h2>
                <div class="p-3 bg-tech-dark-alt/60 rounded-lg border border-tech-dark-alt">
                    <ul class="space-y-2">
            `;
            files.forEach(f => {
                const name = f.split('/').pop();
                const url = shareMap[name] || f;
                html += `<li><a href="${url}" target="_blank" rel="noopener noreferrer" class="text-tech-primary underline">${name}</a></li>`;
            });
            html += `</ul></div>`;
            return html;
        }

        // Function to render concept content
        function renderConcept(conceptTitle) {
            const description = `This section covers the fundamental principles of **${conceptTitle}**. Understanding this concept is crucial for studying geology and Earth sciences.`;

            return `
                <details class="mb-4 bg-tech-dark-alt rounded-xl border border-tech-primary/30 shadow-lg overflow-hidden">
                    <summary class="flex items-center justify-between p-4 cursor-pointer text-lg font-semibold text-tech-light hover:bg-tech-primary/20 transition duration-300">
                        <span class="truncate">${conceptTitle}</span>
                        <svg class="w-5 h-5 ml-2 transition-transform duration-300 arrow-icon flex-shrink-0" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
                    </summary>
                    <div class="px-4 pb-4 pt-2 border-t border-tech-primary/30 space-y-4">
                        <div class="bg-tech-dark-alt/80 p-3 rounded-lg border border-tech-dark-alt">
                            <h4 class="text-md font-bold text-tech-secondary mb-1">Concept Description</h4>
                            <p class="text-tech-light/90 text-sm">${description}</p>
                        </div>

                        ${(videoLinks.concept && videoLinks.concept[conceptTitle]) ? `
                            <div class="mt-3 p-3 bg-tech-dark-alt/50 rounded-lg border border-tech-dark-alt">
                                <h4 class="text-md font-bold text-tech-secondary mb-1">Video</h4>
                                <a href="${videoLinks.concept[conceptTitle]}" target="_blank" rel="noopener noreferrer" class="text-tech-primary hover:text-tech-secondary underline">Watch the explanation on YouTube</a>
                            </div>
                        ` : createLinkBlock('Videos', 'Place for video links/embeds relevant to this concept.')}
                        
                    </div>
                </details>
            `;
        }

        function renderLO(loKey, loData) {
            let html = `
                <h2 class="text-3xl font-extrabold mb-6 text-tech-primary border-b border-tech-secondary/50 pb-2">${loData.title}</h2>
            `;

            // 1. LO summarized video (if provided, moved to top)
            if (videoLinks.loSummarized && videoLinks.loSummarized[loKey]) {
                html += `
                    <div class="mb-6 p-4 bg-tech-dark-alt/60 rounded-lg border border-tech-dark-alt">
                        <h3 class="text-2xl font-bold text-tech-secondary mb-2">LO summarised</h3>
                        <a href="${videoLinks.loSummarized[loKey]}" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 bg-tech-primary text-tech-bg font-semibold rounded-lg hover:bg-tech-secondary transition duration-300">
                            Watch LO ${loKey} Summary &rarr;
                        </a>
                    </div>
                `;
            }

            // 2. Concepts
            loData.concepts.forEach(concept => {
                html += renderConcept(concept);
            });

            // 3. Presentations for this LO
            html += renderFilesForLO(loKey);

            // 4. Test Banks CTA
            html += `
                <div class="mt-8 p-4 bg-tech-bg/80 rounded-lg border border-tech-dark-alt">
                    <p class="text-tech-light/80 mb-3">Looking for practice tests? Check the Test Banks section.</p>
                    <button onclick="handleNavigationClick('test-banks')" class="px-3 py-2 bg-tech-primary text-tech-bg rounded-md font-semibold hover:bg-tech-secondary transition duration-200">Open Test Banks</button>
                </div>
            `;

            return html;
        }

        // Render a Files block for a specific LO (Presentations + LO test-bank links)
        function renderFilesForLO(loKey) {
            const presentations = resourceFiles[loKey] || [];
            const loTestBankUrl = (learningObjectives[loKey] && learningObjectives[loKey].testBankUrl) ? learningObjectives[loKey].testBankUrl : null;
            // Find any test bank files that reference this LO (by filename patterns)
            const loNum = loKey.replace(/[^0-9]/g, '');
            const matchingTestBanks = (resourceFiles.testBanks || []).filter(f => {
                const n = f.toLowerCase();
                return (loNum && (n.includes('lo ' + loNum) || n.includes('lo' + loNum) || n.includes('l.o ' + loNum)));
            });

            if (!presentations.length && !loTestBankUrl && matchingTestBanks.length === 0) return '';

            let html = `
                <div class="mt-8 p-4 bg-tech-bg/60 rounded-lg border border-tech-dark-alt">
                    <h3 class="text-2xl font-bold text-tech-secondary mb-3">Files</h3>
            `;

            if (presentations.length) {
                html += `
                    <div class="mb-4">
                        <h4 class="text-md font-semibold mb-2">Presentations</h4>
                        <ul class="space-y-2">
                `;
                presentations.forEach(f => {
                    const name = (typeof f === 'string') ? f.split('/').pop() : (f.name || f.title || '');
                    const url = shareMap[name] || (typeof f === 'string' ? f : (f.url || f.href || '#'));
                    html += `<li><a href="${url}" target="_blank" rel="noopener noreferrer" class="text-tech-primary underline">${name}</a></li>`;
                });
                html += `</ul></div>`;
            }

            if (loTestBankUrl) {
                html += `
                    <div class="mb-4">
                        <h4 class="text-md font-semibold mb-2">LO Test Bank</h4>
                        <a href="${loTestBankUrl}" target="_blank" rel="noopener noreferrer" class="text-tech-primary underline">Download LO Test Bank</a>
                    </div>
                `;
            }

            if (matchingTestBanks.length) {
                html += `
                    <div class="mb-4">
                        <h4 class="text-md font-semibold mb-2">Related Test Bank Files</h4>
                        <ul class="space-y-2">
                `;
                matchingTestBanks.forEach(f => {
                    const name = f.split('/').pop();
                    const url = shareMap[name] || f;
                    html += `<li><a href="${url}" target="_blank" rel="noopener noreferrer" class="text-tech-primary underline">${name}</a></li>`;
                });
                html += `</ul></div>`;
            }

            html += `</div>`;
            return html;
        }

        function renderAdditionalReferences() {
            let html = `
                <h2 class="text-3xl font-extrabold mb-6 text-tech-primary border-b border-tech-secondary/50 pb-2">Additional References</h2>
                <div class="p-6 bg-tech-dark-alt rounded-xl border border-tech-secondary/50 shadow-subtle-glow">
                    <p class="text-xl font-medium text-tech-light mb-6">
                        Download these files if you want to study deeper in references:
                    </p>
            `;

            // Four placeholder links
            for (let i = 1; i <= 4; i++) {
                const linkTitle = `Advanced Geology Reference Material ${i}`;
                html += `
                    <div class="mb-4">
                        <a href="javascript:void(0)" download="Reference_Material_${i}.pdf"
                            class="text-tech-secondary hover:text-tech-primary transition duration-200 text-lg underline font-semibold">
                            ${linkTitle}
                        </a>
                    </div>
                `;
            }

            html += `</div>`;
            return html;
        }

        function handleNavigationClick(loKey) {
            const contentArea = document.getElementById('dynamic-content');
            const defaultMessage = document.getElementById('default-message');
            const loItems = document.querySelectorAll('.lo-item');

            loItems.forEach(item => item.classList.remove('active'));
            const target = document.getElementById(`lo-${loKey}`);
            if (target) target.classList.add('active');

            if (defaultMessage) defaultMessage.style.display = 'none';

            if (loKey === 'test-banks') {
                contentArea.innerHTML = renderTestBanks();
            } else if (loKey === 'revisions') {
                contentArea.innerHTML = renderRevisions();
            } else if (loKey === 'additional-resources') {
                contentArea.innerHTML = renderAdditionalResources();
            } else if (learningObjectives[loKey]) {
                contentArea.innerHTML = renderLO(loKey, learningObjectives[loKey]);
            } else {
                contentArea.innerHTML = `<h2 class="text-red-400">Error: LO not found.</h2>`;
            }

            document.getElementById('content-area').scrollTop = 0;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const loList = document.getElementById('lo-list');

            // Add Test Banks and Revisions top-level sidebar entries
            loList.innerHTML = `
                <li>
                    <button id="lo-test-banks" class="lo-item w-full text-left p-3 rounded-lg border-l-4 border-tech-dark-alt transition duration-200 hover:bg-tech-primary/10 hover:border-tech-primary font-medium text-sm sm:text-base" data-lo-key="test-banks">Test Banks</button>
                </li>
                <li>
                    <button id="lo-revisions" class="lo-item w-full text-left p-3 rounded-lg border-l-4 border-tech-dark-alt transition duration-200 hover:bg-tech-primary/10 hover:border-tech-primary font-medium text-sm sm:text-base" data-lo-key="revisions">Revisions</button>
                </li>
                <li>
                    <button id="lo-additional-resources" class="lo-item w-full text-left p-3 rounded-lg border-l-4 border-tech-dark-alt transition duration-200 hover:bg-tech-primary/10 hover:border-tech-primary font-medium text-sm sm:text-base" data-lo-key="additional-resources">Additional Resources</button>
                </li>
            `;

            // Then append each LO
            Object.keys(learningObjectives).forEach(key => {
                const displayText = learningObjectives[key].title;
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <button id="lo-${key}" 
                        class="lo-item w-full text-left p-3 rounded-lg border-l-4 border-tech-dark-alt transition duration-200 
                               hover:bg-tech-primary/10 hover:border-tech-primary font-medium text-sm sm:text-base"
                        data-lo-key="${key}">
                        <span class="truncate">${displayText}</span>
                    </button>
                `;
                loList.appendChild(listItem);
            });

            loList.addEventListener('click', (event) => {
                const button = event.target.closest('.lo-item');
                if (button) {
                    const loKey = button.getAttribute('data-lo-key');
                    handleNavigationClick(loKey);
                }
            });

            // Initialize first render
            handleNavigationClick('LO1');

            // Theme toggle initialization (default to dark)
            const themeToggleBtn = document.getElementById('theme-toggle');
            const themeToggleIcon = document.getElementById('theme-toggle-icon');

            function setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                if (themeToggleIcon) {
                    if (theme === 'dark') {
                        themeToggleIcon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
                    } else {
                        themeToggleIcon.innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
                    }
                }
            }

            // Christmas / Language Logic
            const translations = {
                en: { "settings": "Settings", "language": "Language", "theme": "Theme", "close": "Close", "footer_contact": "If you have any comments please text me" },
                ar: { "settings": "الإعدادات", "language": "اللغة", "theme": "السمة", "close": "إغلاق", "footer_contact": "إذا كان لديك أي تعليقات يرجى مراسلتي" }
            };
            function updateText(lang) {
                const t = translations[lang];
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (t[key]) el.textContent = t[key];
                });
            }
            function setLanguage(lang) {
                document.documentElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
                document.documentElement.setAttribute('lang', lang);
                localStorage.setItem('language', lang);
                updateText(lang);
            }
            function setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);

                // Use centralized effects
                if (window.ThemeEffects) {
                    window.ThemeEffects.setEffect(theme);
                } else {
                    if (theme === 'christmas') {
                        startSnow();
                    } else {
                        stopSnow();
                    }
                }

                // Update theme icon if present
                const themeToggleIcon = document.getElementById('theme-toggle-icon');
                if (themeToggleIcon) {
                    if (theme === 'dark') {
                        themeToggleIcon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
                    } else {
                        themeToggleIcon.innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
                    }
                }
            }

            // Snow (Fallback)
            function startSnow() {
                const c = document.getElementById('snow-container'); if (!c) return; stopSnow();
                window.snowInterval = setInterval(() => {
                    const s = document.createElement('div');
                    s.className = 'snowflake';
                    s.style.left = Math.random() * 100 + 'vw';
                    s.style.width = s.style.height = (Math.random() * 5 + 3) + 'px';
                    s.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    s.style.opacity = Math.random();
                    c.appendChild(s);
                    setTimeout(() => s.remove(), 5000);
                }, 100);
            }
            function stopSnow() { if (window.snowInterval) clearInterval(window.snowInterval); const c = document.getElementById('snow-container'); if (c) c.innerHTML = ''; }

            // Init
            setLanguage(localStorage.getItem('language') || 'en');
            const saved = localStorage.getItem('theme');
            if (saved) setTheme(saved); else setTheme('dark');

            // Listeners
            document.getElementById('open-settings')?.addEventListener('click', (e) => { e.preventDefault(); document.getElementById('settings-modal').classList.remove('hidden'); });
            document.getElementById('close-settings')?.addEventListener('click', () => document.getElementById('settings-modal').classList.add('hidden'));
            document.getElementById('settings-modal')?.addEventListener('click', (e) => { if (e.target === document.getElementById('settings-modal')) document.getElementById('settings-modal').classList.add('hidden'); });
            document.getElementById('lang-en')?.addEventListener('click', () => setLanguage('en'));
            document.getElementById('lang-ar')?.addEventListener('click', () => setLanguage('ar'));
            document.getElementById('theme-dark')?.addEventListener('click', () => setTheme('dark'));
            document.getElementById('theme-midnight')?.addEventListener('click', () => setTheme('midnight'));
            document.getElementById('theme-christmas')?.addEventListener('click', () => setTheme('christmas'));
            document.getElementById('theme-space')?.addEventListener('click', () => setTheme('space'));

            // Legacy Toggle Listener
            const legacyToggle = document.getElementById('theme-toggle');
            if (legacyToggle) legacyToggle.addEventListener('click', () => { setTheme(document.documentElement.getAttribute('data-theme') === 'dark' ? 'christmas' : 'dark'); });

        });
    </script>
</head>

<body class="bg-tech-bg text-tech-light min-h-screen flex flex-col">
    <!-- Dark Neon Background Effects -->
    <div class="cyber-wrapper">
        <div class="cyber-grid"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- Header -->
    <header
        class="w-full bg-tech-dark-alt p-4 shadow-xl shadow-tech-primary/10 border-b border-tech-primary/30 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <!-- Left: Back Button & Logo -->
            <div class="flex items-center space-x-4">
                <button onclick="window.location.href='../index.html'"
                    class="text-tech-light hover:text-tech-secondary transition duration-200 p-2 rounded-full hover:bg-tech-primary/20">
                    <!-- Back Arrow SVG Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 12H5" />
                        <path d="m12 19-7-7 7-7" />
                    </svg>
                </button>

                <!-- NEW LOGO: "Stemawy" link -->
                <a href="../index.html"
                    class="flex items-center space-x-2 text-2xl font-extrabold transition duration-200 hover:opacity-80">
                    <span class="gradient-text-wrapper gradient-h1">Stemawy</span>
                </a>
            </div>

            <!-- Center: Title -->
            <h1 class="text-4xl font-extrabold tracking-tight">
                <span class="gradient-text-wrapper gradient-h1">GEOLOGY</span>
            </h1>

            <!-- Right: Theme toggle -->
            <div class="flex items-center">
                <button id="theme-toggle" class="p-2 rounded-md hover:bg-tech-primary/10 transition"
                    title="Toggle theme">
                    <svg id="theme-toggle-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Area: Sidebar and Main Section -->
    <main class="flex flex-1 overflow-hidden max-w-7xl mx-auto w-full p-4 sm:p-6">

        <!-- Left Sidebar (LO Navigation) -->
        <nav id="sidebar"
            class="w-full sm:w-64 bg-tech-dark-alt rounded-xl p-4 mr-6 flex-shrink-0 border border-tech-primary/20 h-full overflow-y-auto">
            <h2
                class="text-lg font-bold mb-4 text-tech-secondary uppercase tracking-wider border-b border-tech-secondary/30 pb-2">
                Learning Objectives</h2>
            <ul id="lo-list" class="space-y-2">
                <!-- LO items will be generated here -->
            </ul>
        </nav>

        <!-- Right Content Area -->
        <section id="content-area"
            class="flex-1 bg-tech-dark-alt rounded-xl p-6 border border-tech-primary/50 shadow-subtle-glow">
            <div id="dynamic-content" class="h-full">
                <!-- Default State -->
                <div id="default-message"
                    class="flex items-center justify-center h-full text-3xl font-light text-tech-light/50">
                    Please choose your checkpoint
                </div>
                <!-- Content will be rendered here -->
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="w-full bg-tech-dark-alt p-4 mt-auto border-t border-tech-primary/30 relative z-20">
        <div class="section-container flex flex-col sm:flex-row justify-between items-center text-sm">
            <div class="text-center sm:text-left order-2 sm:order-1 mt-4 sm:mt-0">
                <span data-i18n="footer_contact">If you have any comments please text me</span> <a
                    href="mailto:yassoalaa822@gmail.com"
                    class="text-tech-secondary hover:text-tech-primary transition duration-200">yassoalaa822@gmail.com</a>
            </div>
            <div class="space-x-4 order-1 sm:order-2">
                <a href="#" id="open-settings" class="hover:text-tech-primary transition duration-200"
                    data-i18n="settings">Settings</a>
            </div>
        </div>
    </footer>
    <div id="snow-container"></div>
    <div id="settings-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
        <div
            class="bg-tech-dark-alt rounded-2xl border border-tech-secondary/50 shadow-2xl p-6 w-full max-w-sm transform transition-all scale-100">
            <div class="flex justify-between items-center mb-6 border-b border-tech-primary/20 pb-4">
                <h3 class="text-2xl font-bold text-tech-primary" data-i18n="settings">Settings</h3>
                <button id="close-settings" class="text-tech-light hover:text-tech-secondary"><svg
                        xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg></button>
            </div>
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-tech-secondary uppercase tracking-wider mb-3"
                    data-i18n="language">Language</h4>
                <div class="grid grid-cols-2 gap-3"><button id="lang-en"
                        class="p-2 rounded-lg border border-tech-primary/30 hover:bg-tech-primary/10 text-center transition">English</button><button
                        id="lang-ar"
                        class="p-2 rounded-lg border border-tech-primary/30 hover:bg-tech-primary/10 text-center transition font-['Tajawal']">العربية</button>
                </div>
            </div>
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-tech-secondary uppercase tracking-wider mb-3" data-i18n="theme">
                    Theme</h4>
                <div class="grid grid-cols-2 gap-3">
                    <button id="theme-dark"
                        class="p-2 rounded-lg border border-tech-primary/30 hover:bg-tech-primary/10 text-center transition">Dark
                        Neon</button>
                    <button id="theme-midnight"
                        class="p-2 rounded-lg border border-pink-500/50 hover:bg-pink-500/10 text-center transition text-pink-300">Midnight
                        🌆</button>
                    <button id="theme-christmas"
                        class="p-2 rounded-lg border border-red-500/50 hover:bg-red-500/10 text-center transition text-red-300">Christmas
                        🎄</button>
                    <button id="theme-space"
                        class="p-2 rounded-lg border border-tech-primary/30 hover:bg-tech-primary/10 text-center transition text-tech-primary"
                        data-i18n="theme_space">Space 🚀</button>
                </div>
            </div>
            <button onclick="document.getElementById('settings-modal').classList.add('hidden')"
                class="w-full py-2 bg-tech-primary text-tech-bg font-bold rounded-lg hover:bg-tech-secondary transition"
                data-i18n="close">
                Close
            </button>
        </div>
    </div>
    <script src="../space-theme.js"></script>
    <script src="../theme-effects.js"></script>
</body>

</html>